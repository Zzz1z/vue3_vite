var ee=Object.defineProperty,te=Object.defineProperties;var ne=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var oe=Object.prototype.hasOwnProperty,se=Object.prototype.propertyIsEnumerable;var F=(e,t,n)=>t in e?ee(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,B=(e,t)=>{for(var n in t||(t={}))oe.call(t,n)&&F(e,n,t[n]);if(D)for(var n of D(t))se.call(t,n)&&F(e,n,t[n]);return e},T=(e,t)=>te(e,ne(t));import{r as O,o as i,c as p,a as u,d as L,u as K,b as P,E as re,e as ae,f as ce,g as m,h as S,w as d,F as v,i as x,j as y,t as E,k as U,l as w,p as ie,m as le,n as W,q as ue,s as $,N as f,v as de,x as _e,y as pe,z as fe,A as he,B as me,C as ge,D as ve,G as ye,H as Ee,I as we,J as Ce,K as ke}from"./vendor.f3c832c0.js";const Ie=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerpolicy&&(s.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?s.credentials="include":o.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}};Ie();var k=(e,t)=>{const n=e.__vccOpts||e;for(const[r,o]of t)n[r]=o;return n};const Se={},xe={class:"app"};function Re(e,t){const n=O("router-view");return i(),p("div",xe,[u(n)])}var Ae=k(Se,[["render",Re]]);const Oe="modulepreload",V={},Le="/",R=function(t,n){return!n||n.length===0?t():Promise.all(n.map(r=>{if(r=`${Le}${r}`,r in V)return;V[r]=!0;const o=r.endsWith(".css"),s=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${s}`))return;const a=document.createElement("link");if(a.rel=o?"stylesheet":Oe,o||(a.as="script",a.crossOrigin=""),a.href=r,document.head.appendChild(a),o)return new Promise((l,_)=>{a.addEventListener("load",l),a.addEventListener("error",_)})})).then(()=>t())};var Pe="/assets/logo.03d6d6da.png";const Me=e=>(ie("data-v-0e6eb90d"),e=e(),le(),e),be={class:"logo-wrap"},Ne={class:"logo"},De=Me(()=>m("img",{class:"img",src:Pe,alt:"logo"},null,-1)),Fe={key:0,class:"title"},Be=["src"],Te=["src"],$e=["src"],Ve=L({props:{routes:{type:Object},collapse:{type:Boolean}},setup(e){const t=K(),n=P(()=>{const{path:s}=t;return s}),r=()=>{},o=()=>{};return(s,a)=>{const l=re,_=ae,g=ce;return i(),p("div",be,[m("div",Ne,[De,e.collapse?S("v-if",!0):(i(),p("span",Fe,"Ts+Vue3"))]),u(g,{"default-active":w(n),router:"","unique-opened":"",onOpen:r,onClose:o},{default:d(()=>[(i(!0),p(v,null,x(e.routes,c=>(i(),p(v,{key:c.path},[c.children?(i(),y(_,{key:0,index:c.path},{title:d(()=>[m("img",{src:c.meta.icon,alt:""},null,8,Be),S(" <el-icon><item.icon></item.icon>></el-icon> "),m("span",null,E(c.meta.title),1)]),default:d(()=>[(i(!0),p(v,null,x(c.children,h=>(i(),p(v,{key:h.path},[h.hidden?S("v-if",!0):(i(),y(l,{key:0,index:h.path},{title:d(()=>[m("img",{src:h.img},null,8,Te),m("span",null,E(h.meta.title),1)]),_:2},1032,["index"]))],64))),128))]),_:2},1032,["index"])):(i(),y(l,{key:1,index:c.index},{title:d(()=>[U(E(c.meta.title),1)]),default:d(()=>[m("img",{src:c.img},null,8,$e)]),_:2},1032,["index"]))],64))),128))]),_:1},8,["default-active"])])}}});var qe=k(Ve,[["__scopeId","data-v-0e6eb90d"]]);const He={class:"nav-header"},Ke=L({emits:["foldChange"],setup(e,{emit:t}){const n=W(!1),r=P(()=>n.value?"Expand":"Fold"),o=()=>{n.value=!n.value,t("foldChange",n.value)};return(s,a)=>{const l=O("Icon");return i(),p("div",He,[u(l,{onClick:o,class:"fold-menu",icon:w(r)},null,8,["icon"])])}}});var Ue=k(Ke,[["__scopeId","data-v-08031c8a"]]);function ot(e,t){window.localStorage.setItem(e,t)}function z(e){return window.localStorage.getItem(e)}const C=ue.create({baseURL:"https://dev3-api.doneke.com/v1/system/",timeout:6e3,headers:{"Content-Type":"application/json;charset=UTF-8"}});C.interceptors.request.use(e=>{const t=z("ACCESS_TOKEN");return t&&(e.headers.Authorization="Bearer "+t),e},e=>e);C.interceptors.response.use(e=>{let t=e.data;return t.code!=="000"&&$.error({title:"\u63D0\u793A",message:t.msg}),t.code==401&&$.error({title:"\u63D0\u793A",message:"\u767B\u5F55\u5931\u6548"}),Promise.resolve(e.data)});const M={get(e,t){return new Promise((n,r)=>{f.start(),C.get(e,{params:t}).then(o=>{n(o)}).catch(o=>{r(o)}).finally(()=>{f.done()})})},post(e,t){return new Promise((n,r)=>{f.start(),C.post(e,t).then(o=>{n(o)}).catch(o=>{r(o)}).finally(()=>{f.done()})})}},st=e=>M.post("auth/account-login",e),We=()=>M.post("auth/logout"),ze=()=>M.get("sysauth/auth-info"),G=de({id:"main",state:()=>({token:"",userInfo:{id:null,authInfo:[]},addRouters:[]}),getters:{asyncRouterMap:e=>e.addRouters},actions:{updateToken(e){this.token=e},async getAuthInfo(){const e=await ze();this.userInfo.authInfo=e.data.auth_info},logout(){return new Promise(e=>{We().then(t=>{e(t)}).catch(t=>{e(t)})})}}});const Ge={class:"layout-wrap"},Je=L({setup(e){const n=G().addRouters,r=K(),o=W(!1),s=P(()=>(r==null?void 0:r.matched).map(_=>{var g,c;return{title:(c=(g=_==null?void 0:_.meta)==null?void 0:g.title)!=null?c:"",path:_.path}})),a=l=>{o.value=l};return(l,_)=>{const g=_e,c=pe,h=fe,X=he,Y=O("router-view"),Z=me,b=ge;return i(),p("div",Ge,[u(b,{class:"layout-content"},{default:d(()=>[u(g,{class:"layout-aside",width:o.value?"60px":"210px"},{default:d(()=>[u(qe,{routes:w(n),collapse:o.value},null,8,["routes","collapse"])]),_:1},8,["width"]),u(b,{class:"layout-page"},{default:d(()=>[u(c,{class:"layout-page-header"},{default:d(()=>[u(Ue,{onFoldChange:a})]),_:1}),u(Z,{class:"layout-page-content"},{default:d(()=>[u(X,{separator:"/"},{default:d(()=>[(i(!0),p(v,null,x(w(s),(N,j)=>(i(),y(h,{key:j,to:{path:N.path}},{default:d(()=>[U(E(N.title),1)]),_:2},1032,["to"]))),128))]),_:1}),u(Y,{class:"layout-main-content"})]),_:1})]),_:1})]),_:1})])}}});var Qe=k(Je,[["__scopeId","data-v-60f35ab6"]]);const Xe=[{path:"/login",name:"Login",component:()=>R(()=>import("./Login.1ad20cf9.js"),["assets/Login.1ad20cf9.js","assets/Login.503eaab8.css","assets/vendor.f3c832c0.js","assets/vendor.e5f04527.css"])}],Ye=[{path:"/",name:"Dashboard",component:Qe,meta:{title:"\u5DE5\u4F5C\u53F0",icon:"home",permission:"ownerlist_investment"},hidden:!1,redirect:"/dashboard/work",children:[{path:"/dashboard/work",name:"Work",component:()=>R(()=>import("./Work.69770f31.js"),["assets/Work.69770f31.js","assets/vendor.f3c832c0.js","assets/vendor.e5f04527.css"]),meta:{title:"\u4E1A\u52A1",icon:"",permission:"ownerlist_investment"},hidden:!1},{path:"/dashboard/detail",name:"Detail",component:()=>R(()=>import("./Work.69770f31.js"),["assets/Work.69770f31.js","assets/vendor.f3c832c0.js","assets/vendor.e5f04527.css"]),meta:{title:"\u8BE6\u60C5",icon:"",permission:"ownerlist_investment"},hidden:!1}]}],A=ve({history:ye(),routes:Xe,scrollBehavior(e,t,n){return n||{top:0}}});function J(e,t=[]){if(e===null||typeof e!="object")return e;const n=Object.prototype.toString.call(e).slice(8,-1);if(n==="RegExp")return new RegExp(e);if(n==="Date")return new Date(e);if(n==="Error")return new Error(e);const r=t.filter(s=>s.original===e)[0];if(r)return r.copy;const o=Array.isArray(e)?[]:{};return t.push({original:e,copy:o}),Object.keys(e).forEach(s=>{o[s]=J(e[s],t)}),o}function Q(e,t){let n=J(e);const r=t.map(s=>s.url);return n.filter(s=>Ze(r,s)?(s.children&&s.children.length&&(s.children=Q(s.children,t)),!0):!1)}function Ze(e,t){if(t.meta&&t.meta.permission){let n=!1;for(let r=0,o=e.length;r<o;r++)if(n=t.meta.permission.includes(e[r]),n)return!0;return!1}return!0}const q=["/login"],je="/";f.configure({showSpinner:!1});let H=!1;A.beforeEach(async(e,t,n)=>{var r;if(f.start(),q.indexOf(e.path)!==-1)n(),f.done();else if((r=z("ACCESS_TOKEN"))!=null?r:null)if(e.path==="/login")n({path:je}),f.done();else{if(H)n();else{const s=G();if(s.userInfo.authInfo.length===0){await s.getAuthInfo();const a=s.userInfo.authInfo,l=Q(Ye,a);s.addRouters=l,l.forEach(_=>{A.addRoute(_)}),H=!0,n(T(B({},e),{replace:!0}))}}f.done()}else q.indexOf(e.path)!==-1?n():(n({path:"/login"}),f.done())});const I=Ee(Ae),et=e=>{const{icon:t}=e;return u(ke[t])};I.component("Icon",et);I.config.globalProperties.$SUCCESS_CODE="000";I.config.globalProperties.$message=we;I.use(A).use(Ce()).mount("#app");export{k as _,st as l,ot as s,G as u};
